# Sequence

Generates sequential values within the specified range.

## Implementation by builder

Describes how to define fields using DataGeneratorBuilder.

### Sample code

```c#
// Creates a builder.
DataGeneratorBuilder builder = new DataGeneratorBuilder();

// Adds fields.
builder
    .AddField(factory => factory.SequenceInt32(
        "SEQUENCE_INT32",
        // Specifies the initial value.
        1,
        // Specifies the maximum value.
        100,
        // Specifies the increment.
        2,
        // Specifies the probability of returning null.
        0.1
        ))
    .AddField(factory => factory.SequenceDateTime(
        "SEQUENCE_DATETIME",
        // Specifies the initial value.
        DateTime.Today,
        // Specifies the maximum value.
        DateTime.Today.AddDays(10),
        // Specifies the increment.
        TimeSpan.FromHours(12),
        // Specifies the probability of returning null.
        0.1
        ))
    .AddField(factory => factory.SequenceDateMonth(
        "SEQUENCE_DATEMONTH",
        // Specifies the initial value.
        new DateTime(2021, 1, 31),
        // Specifies the maximum value.
        new DateTime(2021, 12, 31),
        // Specifies the increment.
        1,
        // Specifies the probability of returning null.
        0.1
        ))
    ;
 
// Creates a generator that generates 10 records and returns it as a DataReader.
using IDataReader reader = await builder.BuildAsDataReaderAsync(10);
```

The IDataReader generated by this sample code will generate the following data:

```console
SEQUENCE_INT32  SEQUENCE_DATETIME       SEQUENCE_DATEMONTH
----------      ----------              ----------
1               2021/06/19 0:00:00      2021/01/31 0:00:00
3               2021/06/19 12:00:00     2021/02/28 0:00:00
5               2021/06/20 0:00:00      (null)
7               2021/06/20 12:00:00     2021/04/30 0:00:00
9               2021/06/21 0:00:00      2021/05/31 0:00:00
11              (null)                  2021/06/30 0:00:00
13              2021/06/22 0:00:00      2021/07/31 0:00:00
15              2021/06/22 12:00:00     2021/08/31 0:00:00
17              2021/06/23 0:00:00      2021/09/30 0:00:00
19              2021/06/23 12:00:00     2021/10/31 0:00:00
```

## Implementation by configuration

Describes how to use a configuration class to define the same fields as the sample code above.

### Sample code

```c#
// Creates a generator settings.
DataGeneratorSettings generatorSetting = new DataGeneratorSettings() { };

// Adds fields.
generatorSetting.Fields = new DataGeneratorFieldSettings[]
{
    new SequenceInt32FieldSettings()
    {
        FieldName = "SEQUENCE_INT32",
        // Specifies the initial value.
        InitialValue = 1,
        // Specifies the maximum value.
        MaximumValue = 100,
        // Specifies the increment.
        Increment = 2,
        // Specifies the probability of returning null.
        NullProbability = 0.1
    },
    new SequenceDateTimeFieldSettings()
    {
        FieldName = "SEQUENCE_DATETIME",
        // Specifies the initial value.
        InitialValue = DateTime.Today,
        // Specifies the maximum value.
        MaximumValue = DateTime.Today.AddDays(10),
        // Specifies the increment.
        Increment = TimeSpan.FromHours(12),
        // Specifies the probability of returning null.
        NullProbability = 0.1
    },
    new SequenceDateMonthFieldSettings()
    {
        FieldName = "SEQUENCE_DATEMONTH",
        // Specifies the initial value.
        InitialValue = new DateTime(2021, 1, 31),
        // Specifies the maximum value.
        MaximumValue = new DateTime(2021, 12, 31),
        // Specifies the increment.
        Increment = 1,
        // Specifies the probability of returning null.
        NullProbability = 0.1
    }
};

// Create a context that controls the behavior of the generator.
// You can replace random number generation algorithms, string converters, etc. with your own implementation.
DataGeneratorContext context = new DataGeneratorContext();

// Creates a builder.
DataGeneratorBuilder builder = generatorSetting.CreateBuilder(context);

// Creates a generator that generates 10 records and returns it as a DataReader.
using IDataReader reader = await builder.BuildAsDataReaderAsync(10);
```


### Json serialization

The DataGeneratorSettings instance in the sample code above is serialized into a JSON string like this: 

```json
{
  "Fields": [
    {
      "Name": "SEQUENCE_INT32",
      "NullProb": 0.1,
      "Initial": 1,
      "Max": 100,
      "Increment": 2,
      "FieldType": "SequenceInt32"
    },
    {
      "Name": "SEQUENCE_DATETIME",
      "NullProb": 0.1,
      "Initial": "2021-09-23T00:00:00+09:00",
      "Max": "2021-10-03T00:00:00+09:00",
      "Increment": "12:00:00",
      "FieldType": "SequenceDateTime"
    },
    {
      "Name": "SEQUENCE_DATEMONTH",
      "NullProb": 0.1,
      "Initial": "2021-01-31T00:00:00",
      "Max": "2021-12-31T00:00:00",
      "Increment": 1,
      "FieldType": "SequenceDateMonth"
    }
  ],
  "TupleFields": null,
  "AdditionalFields": null,
  "AdditionalTupleFields": null
}
```


## Supported value types

`Sequence` supports the following types:

|Type|Configuration Type|JsonSubTypeName|
|:--|:--|:--|
|byte|SequenceByteFieldSettings|SequenceByte|
|short|SequenceInt16FieldSettings|SequenceInt16|
|int|SequenceInt32FieldSettings|SequenceInt32|
|long|SequenceInt64FieldSetting|SequenceInt64|
|sbyte|SequenceSByteFieldSettings|SequenceSByte|
|ushort|SequenceUInt16FieldSettings|SequenceUInt16|
|uint|SequenceUInt32FieldSettings|SequenceUInt32|
|ulong|SequenceUInt64FieldSetting|SequenceUInt64|
|DateTime|SequenceDateTimeFieldSettings|SequenceDateTime|
|DateTime|SequenceDateMonthFieldSettings|SequenceDateMonth|
|DateTimeOffset|SequenceDateTimeOffsetFieldSettings|SequenceDateTimeOffset|
|DateTimeOffset|SequenceDateMonthOffsetFieldSettings|SequenceDateMonthOffset|
|TimeSpan|SequenceTimeSpanFieldSettings|SequenceTimeSpan|
|(all types above)|SequenceFieldSettings|Sequence|


## Monthly sequence value

* For DateTime and DateTimeOffset, this library supports the field that increment the specified TimeSpan value and the field that increment the number of months. 

* The Monthly sequence field returns the last day of the month if the resulting date of the increment exceeds the last day of the month.

  * ex) 2021/01/31 --> 2021/02/28 --> 2021/03/31 --> 2021/04/30